<%= modal close_on_submit: false do %>
  <div class="flex flex-col gap-4">
    <%= form_with url: search_path, method: :get, data: { turbo_frame: :results, controller: "debounce" } do |form| %>
      <%= form.search_field :query, autofocus: true, data: { action: "keydown.esc->dialog#close debounce#submit" }, class: "form-input", placeholder: t("search.index.title") %>
    <% end %>

    <%= turbo_frame_tag :results do %>
      <% if @organizations.present? || @books.present? %>
        <div class="space-y-4">
          <% if @organizations.present? %>
            <ul class="du-list bg-base-100 rounded-box shadow-md">
              <li class="p-4 pb-2 text-xs opacity-60 tracking-wide">Organizations</li>
              <%= render partial: "organization", collection: @organizations %>
            </ul>
          <% end %>

          <% if @books.present? %>
            <ul class="du-list bg-base-100 rounded-box shadow-md">
              <li class="p-4 pb-2 text-xs opacity-60 tracking-wide">Books</li>
              <%= render partial: "book", collection: @books %>
            </ul>
          <% end %>
        </div>
      <% elsif params[:query].present? %>
        <div class="bg-base-100 rounded-box shadow-md p-6 text-center space-y-3">
          <div class="text-base-content/60">
            <%= inline_svg_tag "svg/magnifying-glass.svg", class: "size-12 mx-auto" %>
          </div>
          <div class="font-medium text-base-content/80">No results found</div>
          <div class="text-sm text-base-content/60">
            Try adjusting your search terms
          </div>
        </div>
      <% end %>
    <% end %>
  </div>
<% end %>